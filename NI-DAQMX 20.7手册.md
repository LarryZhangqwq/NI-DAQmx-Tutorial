# NI-DAQMX 20.7手册

## 0. 入门

### 0.1 NI-DAQmx概述

NI-DAQmx是用于与NI数据采集(DAQ)设备通信并控制设备的驱动程序软件。它包含一个用途广泛的函数和VI库，可从LabVIEW或LabWindows/CVI中调用库函数，对NI设备进行编程。

Measurement＆Automation Explorer (MAX)和DAQ助手是随NI-DAQmx自动安装的应用程序。

可在在MAX或LabVIEW、SignalExpress、LabWindows/CVI、Measurement Studio等NI应用软件中打开DAQ助手。通过DAQ助手，可︰

- 创建和编辑任务及虚拟通道
- 向任务添加虚拟通道
- 创建和编辑换算
- 测试自定义配置
- 保存自定义配置
- 在NI应用软件中生成代码以用于自定义应用程序。
- 查看传感器的连线图。

### 0.2 查找范例

每个API均提供一组编程范例，以方便用户开发应用程序。用户可修改范例代码，然后将代码保存在应用程序中。用户可使用范例开发新的应用程序，或将范例添加至现有应用程序中。

使用NI-DAQmx仿真设备，无需安装硬件就可以运行范例。在MAX中，选择帮助 -> 帮助主题 -> NI-DAQmx，查看*NI-DAQmx的MAX帮助*，获取更多关于NI-DAQmx仿真设备的信息。

### 0.3 疑难解答

* https://www.ni.com/documentation/zhs/ni-daqmx/20.1/gettingstarted/troubleshooting/

## 1. 测量基础

### 1.1 测量系统概述－硬件和NI-DAQmx

<img src="/image/GUID-9D481B1D-EACA-4873-8632-99D6F735613E-5.5x8.5 - a5.png" alt="GUID-9D481B1D-EACA-4873-8632-99D6F735613E-5.5x8.5 - a5" style="zoom: 67%;" />

NI-DAQmx驱动软件中包含的应用软件可用于对NI测量设备编程（例如，配置、采集、生成和发送数据至NI测量设备）。使用NI-DAQmx可节省编程时间。应用程序（例如，LabVIEW、LabWindows™/CVI™和Measurement Studio）发送命令至驱动软件。例如，获取和返回热偶的读取值并显示和分析得到的数据。

通过NI应用软件或支持使用ANSI C接口调用动态链接库(DLL)的编程环境，可调用NI-DAQmx驱动程序。在任意编程环境中，DAQ应用均使用NI-DAQmx。

### 1.2 信号类型

<img src="/image/GUID-20D703F9-19D5-4B1D-88DC-04281846846B-5.5x8.5 - a5.png" alt="GUID-20D703F9-19D5-4B1D-88DC-04281846846B-5.5x8.5 - a5." style="zoom: 100%;" />

#### 1.2.1 模拟信号连接注意事项

**测量模拟信号前，必须确定信号源为接地或浮接，还必须考虑测量系统为差分、参考单端或非参考单端。**

* [接地信号源](https://www.ni.com/documentation/zhs/ni-daqmx/20.1/measfunds/groundsig/#GUID-A41EE540-F1EF-46F8-9D86-B72704F24216)
* [浮接信号源](https://www.ni.com/documentation/zhs/ni-daqmx/20.1/measfunds/floatsig/#GUID-EAC91D96-DE8A-47B7-BBEF-B53B37B190C2)
* [差分测量系统](https://www.ni.com/documentation/zhs/ni-daqmx/20.1/measfunds/diffmeassys/)
* [参考和非参考单端测量系统](https://www.ni.com/documentation/zhs/ni-daqmx/20.1/measfunds/refsingleended/)

#### 1.2.2 连接模拟输入信号

### 1.3 信号调理

传感器可生成用于测量物理现象（例如，温度、力、声音和光）的电信号。如需测量传感器的信号，必须将其转换为DAQ设备可读取的格式。例如，热电偶的输出电压很小且易被噪声干扰。因此，在转换为数字信号前，必须进行放大和滤波处理。

使信号适合数字化的过程称为*信号调理*。信号调理通常包括：放大, 线性化, 传感器激励, 隔离

#### 1.3.1 放大

通过增大信号相对于噪声的幅度，提高数字化信号的精度。使最大电压变化等于ADC或数字化仪的最大输入范围，可获得尽可能高的准确性。系统应通过最接近信号源的测量设备放大低电平信号。

<img src="/image/GUID-3865E721-F72F-46FF-8CF2-512BB75F12F4-5.5x8.5 - a5.png" alt="GUID-3865E721-F72F-46FF-8CF2-512BB75F12F4-5.5x8.5 - a5." style="zoom: 100%;" />

如通过测量设备放大信号，则测量和数字化的信号中可能包含由导线引入的噪声。在接近信号源的位置通过SCXI模块放大信号，可减少噪声对被测信号的影响。

**Note: 应使用屏蔽式电缆或双绞线电缆。通过减小电缆长度可降低导线引入的噪声。使信号连线远离AC电源电缆和显示器可减少频率为50至60 Hz的噪声。**

#### 1.3.2 线性化

通过软件使传感器产生的信号线性化，换算后的电压可用于物理现象。例如，通常，热电偶10 mV的电压变化并意味着温度的变化为10。但是，通过软件或硬件的线性化处理，应用中的热电偶值可换算为相应的温度变化。绝大多数传感器具有用于说明传感器换算关系的线性化表格。

#### 1.3.3 传感器激励 

信号调理系统可为某些传感器生成激励。应变计和RTD需要外部电压和电流激励电路，然后开始测量物理现象。激励类似于收音机用于接收和解码音频信号所需的电源。许多测量设备可为传感器提供激励。关于设备是否可生成激励，见设备文档

#### 1.3.4 隔离

信号通常会超出测量设备可处理的范围。尝试测量过大的信号可导致测量设备损坏或人身伤害。通过*隔离*信号调理技术可防止人体和测量设备接触过大的电压。信号调理硬件可降低较高的共模电压，获取测量设备可处理的电压信号。通过隔离可避免接地电势差对设备的影响。

### 1.4 常见传感器

不同的应用使用不同的传感器。常见的传感器包括：应变计、热电偶、热电阻、角度编码器、线性编码器、基于电桥的传感器以及电阻式温度检测器(RTD)。

* https://www.ni.com/documentation/zhs/ni-daqmx/20.1/measfunds/cmmnsensor/

### 1.5 控制概述

通常，控制应用中包含一个或多个需控制的过程变量（例如，温度）。传感器可测量动态系统中的过程变量并为应控制应用提供数据。设定点为过程变量要达到的值。比较器可判断过程变量和设定点之间的差。如差不为零且系统判断该值足够大， 补偿器可处理该值并通过执行器的输出驱动系统接近设定点。

<img src="/image/GUID-74BFB5ED-CE8E-4CB7-8436-830393A22A26-5.5x8.5 - a5.png" alt="GUID-74BFB5ED-CE8E-4CB7-8436-830393A22A26-5.5x8.5 - a5" style="zoom: 100%;" />

#### 1.5.1 比例积分微分(PID)

比例积分微分(PID)算法是工业中最常使用的控制算法。通常，PID用于加热和冷却系统、液面监控、流控制和压力控制应用。在PID控制中，必须指定过程变量和设定点。过程变量是要控制的系统参数（例如，温度、压力和流量），设定点是要控制的参数值。PID控制器可确定控制器的输出值（例如，加热器的功率或值位置）。控制器使用控制器输出值控制系统，使过程变量接近设定点的值。

#### 1.5.2 实时

实时是指及时响应。对于非实时系统，无法确定响应发生的时间，操作完成的时间可能早于或晚于预期时间。换句话说，实时系统具有确定性，可保证操作在指定时间内发生。实时系统是可预期的。

对于实时系统，所有部分都必须是实时的。例如，即使程序运行在实时操作系统上，也不意味着程序具有实时特性。程序可能依赖某些非实时动作（例如，文件I/O），导致程序无法实时运行。

#### 1.5.3 循环周期时间

许多应用（例如，控制应用）需使用周期性实时操作系统。周期的开始和结束之间的时间*T*称为*循环周期时间*或采样周期。1/T为循环速率或采样率。即使在实时操作系统中，循环周期也可能变化，但始终小于最大抖动。

#### 1.5.4 控制应用中的抖动

对于控制应用，循环时间与期望时间的差称为抖动。循环时间与期望时间差的最大值称为最大抖动。<img src="/image/GUID-50BF3221-1F1B-4804-8623-CABB7E7FE044-5.5x8.5 - a5.png" alt="GUID-50BF3221-1F1B-4804-8623-CABB7E7FE044-5.5x8.5 - a5" style="zoom:50%;" />

实时系统中的抖动是固定的。例如，安全气囊必须在碰撞发生后的1秒内打开，因此最大抖动为固定值。非实时系统中的抖动不是固定的，变化范围较大。例如，等待公交车。按照计划，公交车应在上午11:00到达，但实际到达时间第一天为上午11:05，第二天为上午11:30，第三天无法到达。对公交车的延误时间没有限制。

#### 1.5.5 事件响应

事件响应应用需要在确定的时间内对发生的事件进行响应。例如，监视引擎的温度。在引擎温度过高时，降低引擎运行的速度。事件是指引擎温度超出预设上限，响应是指降低引擎运行速度。另一个实例来自生产制造过程。在生产线上，系统在检测到零件将要进行一道工序（事件）时，将获取读数或对零件执行操作（响应）。如系统在一段时间内没有检测到零件或没有对零件的出现产生响应，生产线将产生次品零件。

## 2. NI-DAQmx重要概念



## 3. NI-DAQmx设备注意事项



## 4. DAQmx - 数据采集节点



## 5. DAQmx属性



